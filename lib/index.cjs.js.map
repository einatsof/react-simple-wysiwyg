{"version":3,"file":"index.cjs.js","sources":["../src/utils.ts","../src/editor/ContentEditable.tsx","../src/editor/EditorContext.tsx","../src/editor/HtmlEditor.tsx","../src/editor/Editor.tsx","../src/toolbar/icons/OrderedListIcon.tsx","../src/toolbar/icons/UnorderedListIcon.tsx","../src/toolbar/buttons.tsx","../src/toolbar/dropdowns.tsx","../src/toolbar/HtmlButton.tsx","../src/toolbar/Separator.tsx","../src/toolbar/Toolbar.tsx","../src/editor/DefaultEditor.tsx"],"sourcesContent":["export function getSelectedNode(): Node {\r\n  if ((document as any).selection) {\r\n    return (document as any).selection.createRange().parentElement();\r\n  }\r\n\r\n  const selection = window.getSelection();\r\n  if (selection.rangeCount > 0) {\r\n    return selection.getRangeAt(0).startContainer.parentNode;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport function normalizeHtml(str: string): string {\r\n  return str && str.replace(/&nbsp;|\\u202F|\\u00A0/g, ' ');\r\n}\r\n\r\nexport function replaceCaret(el: HTMLElement) {\r\n  // Place the caret at the end of the element\r\n  const target = document.createTextNode('');\r\n  el.appendChild(target);\r\n\r\n  // do not move caret if element was not focused\r\n  const isTargetFocused = document.activeElement === el;\r\n  if (target !== null && target.nodeValue !== null && isTargetFocused) {\r\n    const sel = window.getSelection();\r\n    if (sel !== null) {\r\n      const range = document.createRange();\r\n      range.setStart(target, target.nodeValue.length);\r\n      range.collapse(true);\r\n      sel.removeAllRanges();\r\n      sel.addRange(range);\r\n    }\r\n    if (el instanceof HTMLElement) el.focus();\r\n  }\r\n}\r\n","/* eslint-disable react/prop-types */\r\n\r\nimport * as React from 'react';\r\nimport { normalizeHtml, replaceCaret } from '../utils';\r\n\r\n/**\r\n * Based on https://github.com/lovasoa/react-contenteditable\r\n * A simple component for a html element with editable contents.\r\n */\r\nexport const ContentEditable = React.memo(\r\n  React.forwardRef(function ContentEditable(\r\n    { className, disabled, tagName, value, ...rest }: ContentEditableProps,\r\n    ref: React.ForwardedRef<HTMLElement>,\r\n  ) {\r\n    const elRef = React.useRef<HTMLElement>();\r\n    const htmlRef = React.useRef(value);\r\n    const restRef = React.useRef(rest);\r\n\r\n    React.useEffect(() => {\r\n      restRef.current = rest;\r\n      const el = elRef.current;\r\n      if (el && normalizeHtml(htmlRef.current) !== normalizeHtml(value)) {\r\n        htmlRef.current = value;\r\n        el.innerHTML = value;\r\n        replaceCaret(el);\r\n      }\r\n    });\r\n\r\n    return React.useMemo(() => {\r\n      function onSetRef($el: HTMLElement) {\r\n        elRef.current = $el;\r\n        if (typeof ref === 'function') {\r\n          ref($el);\r\n        } else if (typeof ref === 'object') {\r\n          // eslint-disable-next-line no-param-reassign\r\n          ref.current = $el;\r\n        }\r\n      }\r\n\r\n      function onChange(event: React.SyntheticEvent<any>) {\r\n        const el = elRef.current;\r\n        if (!el) {\r\n          return;\r\n        }\r\n\r\n        const elementHtml = el.innerHTML;\r\n        if (elementHtml !== htmlRef.current) {\r\n          restRef.current.onChange?.({\r\n            ...event,\r\n            target: {\r\n              value: elementHtml,\r\n              name: rest.name,\r\n            } as any,\r\n          });\r\n        }\r\n\r\n        htmlRef.current = elementHtml;\r\n      }\r\n\r\n      return React.createElement(tagName || 'div', {\r\n        ...rest,\r\n        className,\r\n        contentEditable: !disabled,\r\n        dangerouslySetInnerHTML: { __html: value },\r\n        onBlur: (e) => (restRef.current.onBlur || onChange)(e),\r\n        onInput: onChange,\r\n        onKeyDown: (e) => (restRef.current.onKeyDown || onChange)(e),\r\n        onKeyUp: (e) => (restRef.current.onKeyUp || onChange)(e),\r\n        ref: onSetRef,\r\n      });\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [className, disabled, tagName]);\r\n  }),\r\n);\r\n\r\nexport type ContentEditableEvent = React.SyntheticEvent<any, Event> & {\r\n  target: { name?: string; value: string };\r\n};\r\n\r\nexport interface ContentEditableProps\r\n  extends React.HTMLAttributes<HTMLElement> {\r\n  disabled?: boolean;\r\n  contentEditableRef?: (el: HTMLElement) => void;\r\n  name?: string;\r\n  onChange?: (event: ContentEditableEvent) => void;\r\n  tagName?: string;\r\n  value?: string;\r\n}\r\n","import * as React from 'react';\r\n\r\nexport const EditorContext = React.createContext<EditorState>(null);\r\n\r\nexport function EditorProvider({ children }: { children: React.ReactNode }) {\r\n  const [state, setState] = React.useState<EditorState>({\r\n    htmlMode: false,\r\n    update,\r\n  });\r\n\r\n  function update(attrs) {\r\n    setState((prevState) => {\r\n      return {\r\n        ...prevState,\r\n        ...attrs,\r\n        date: Date.now(),\r\n      };\r\n    });\r\n  }\r\n\r\n  return (\r\n    <EditorContext.Provider value={state}>{children}</EditorContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useEditorState(): EditorState {\r\n  const context = React.useContext(EditorContext);\r\n  if (!context) {\r\n    throw new Error('You should wrap your component by EditorProvider');\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nexport interface EditorState {\r\n  update(attrs: Partial<EditorState>): void;\r\n  $el?: HTMLElement;\r\n  $selection?: Node;\r\n  htmlMode: boolean;\r\n}\r\n","import * as React from 'react';\r\n\r\nexport function HtmlEditor({ ...rest }) {\r\n  return <textarea {...rest} />;\r\n}\r\n","import * as React from 'react';\r\nimport { getSelectedNode } from '../utils';\r\nimport { ContentEditable, ContentEditableProps } from './ContentEditable';\r\nimport { useEditorState } from './EditorContext';\r\nimport { HtmlEditor } from './HtmlEditor';\r\nimport '../styles.css';\r\n\r\nexport function Editor({ children, onSelect, ...rest }: EditorProps) {\r\n  const editorState = useEditorState();\r\n\r\n  React.useEffect(() => {\r\n    document.addEventListener('click', onClickOutside);\r\n    return () => document.removeEventListener('click', onClickOutside);\r\n  });\r\n\r\n  function onClickOutside(event: MouseEvent) {\r\n    if (event.target === editorState.$el) {\r\n      return;\r\n    }\r\n\r\n    if (editorState.$el?.contains(event.target as HTMLElement)) {\r\n      return;\r\n    }\r\n\r\n    editorState.update({ $selection: null });\r\n  }\r\n\r\n  function onTextSelect(event: React.SyntheticEvent<HTMLElement>) {\r\n    onSelect?.(event);\r\n    editorState.update({ $selection: getSelectedNode() });\r\n  }\r\n\r\n  function setContentEditableRef($el: HTMLElement) {\r\n    editorState.update({ $el });\r\n  }\r\n\r\n  if (editorState.htmlMode) {\r\n    return (\r\n      <div className=\"rsw-editor\">\r\n        {children}\r\n        <HtmlEditor {...rest} className=\"rsw-ce rsw-html\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"rsw-editor\">\r\n      {children}\r\n      <ContentEditable\r\n        {...rest}\r\n        ref={setContentEditableRef}\r\n        onSelect={onTextSelect}\r\n        className=\"rsw-ce\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\r\nexport interface EditorProps extends ContentEditableProps {}\r\n","import * as React from 'react';\r\n\r\nexport default function OrderedListIcon() {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"20\"\r\n      height=\"20\"\r\n      viewBox=\"0 0 24 24\"\r\n      style={{ verticalAlign: 'text-top' }}\r\n    >\r\n      <path\r\n        fill=\"currentColor\"\r\n        d=\"M6.99938 12.998v-2H20.9994v2H6.99938zm0 6.0001v-2H20.9994v2H6.99938zm0-12.00001v-2H20.9994v2H6.99938zm-4 1v-3h-1v-1h2v4h-1zm-1 9.00001v-1h3v4h-3v-1h2v-.5h-1v-1h1v-.5h-2zM4.25 10c.41421 0 .75.3358.75.75 0 .2024-.08017.3861-.2105.521L3.11983 13H5v1H2v-.9218L4 11H2v-1h2.25z\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import * as React from 'react';\r\n\r\nexport default function UnorderedListIcon() {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"20\"\r\n      height=\"20\"\r\n      viewBox=\"0 0 24 24\"\r\n      style={{ verticalAlign: 'text-top' }}\r\n    >\r\n      <path\r\n        fill=\"currentColor\"\r\n        d=\"M7 5h14v2H7V5zm0 8v-2h14v2H7zM4 4.50001c.83 0 1.5.66992 1.5 1.5 0 .83007-.67 1.5-1.5 1.5s-1.5-.66993-1.5-1.5c0-.83008.67-1.5 1.5-1.5zM4 10.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM7 19v-2h14v2H7zm-3-2.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5z\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import * as React from 'react';\r\nimport type { HTMLAttributes, ReactNode } from 'react';\r\nimport { EditorState, useEditorState } from '../editor/EditorContext';\r\nimport OrderedListIcon from './icons/OrderedListIcon';\r\nimport UnorderedListIcon from './icons/UnorderedListIcon';\r\n\r\nexport const BtnBold = createButton('Bold', 'ùêÅ', 'bold');\r\n\r\nexport const BtnBulletList = createButton(\r\n  'Bullet list',\r\n  <UnorderedListIcon />,\r\n  'insertUnorderedList',\r\n);\r\n\r\nexport const BtnClearFormatting = createButton(\r\n  'Clear formatting',\r\n  'TÃ≤‚Çì',\r\n  'removeFormat',\r\n);\r\n\r\nexport const BtnItalic = createButton('Italic', 'ùë∞', 'italic');\r\n\r\nexport const BtnLink = createButton('Link', 'üîó', ({ $selection }) => {\r\n  if ($selection?.nodeName === 'A') {\r\n    document.execCommand('unlink');\r\n  } else {\r\n    // eslint-disable-next-line no-alert\r\n    document.execCommand('createLink', false, prompt('URL', ''));\r\n  }\r\n});\r\n\r\nexport const BtnNumberedList = createButton(\r\n  'Numbered list',\r\n  <OrderedListIcon />,\r\n  'insertOrderedList',\r\n);\r\n\r\nexport const BtnRedo = createButton('Redo', '‚Ü∑', 'redo');\r\n\r\nexport const BtnUnderline = createButton(\r\n  'Underline',\r\n  <span style={{ textDecoration: 'underline' }}>ùêî</span>,\r\n  'underline',\r\n);\r\n\r\nexport const BtnUndo = createButton('Undo', '‚Ü∂', 'undo');\r\n\r\nfunction createButton(\r\n  title: string,\r\n  content: ReactNode,\r\n  command: ((state: EditorState) => void) | string,\r\n) {\r\n  ButtonFactory.displayName = title.replace(/\\s/g, '');\r\n\r\n  return ButtonFactory;\r\n\r\n  function ButtonFactory(props: HTMLAttributes<HTMLButtonElement>) {\r\n    const editorState = useEditorState();\r\n    const { $selection } = editorState;\r\n\r\n    let active = false;\r\n    if (typeof command === 'string') {\r\n      active = !!$selection && document.queryCommandState(command);\r\n    }\r\n\r\n    function onAction(e: React.MouseEvent<HTMLButtonElement>) {\r\n      e.preventDefault();\r\n      if (typeof command === 'function') {\r\n        command(editorState);\r\n      } else {\r\n        document.execCommand(command);\r\n      }\r\n    }\r\n\r\n    if (editorState.htmlMode) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <button\r\n        type=\"button\"\r\n        title={title}\r\n        {...props}\r\n        className=\"rsw-btn\"\r\n        onMouseDown={onAction}\r\n        data-active={active}\r\n      >\r\n        {content}\r\n      </button>\r\n    );\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport type { ChangeEvent, HTMLAttributes } from 'react';\r\nimport { EditorState, useEditorState } from '../editor/EditorContext';\r\n\r\nexport const BtnStyles = createDropdown('Styles', [\r\n  ['Normal', 'formatBlock', 'P'],\r\n  // ['ùóõùó≤ùóÆùó±ùó≤ùóø ùü≠', 'formatBlock', 'H1'],\r\n  // ['Header 2', 'formatBlock', 'H2'],\r\n  ['ùóõùó≤ùóÆùó±ùó∂ùóªùó¥', 'formatBlock', 'H2'],\r\n  ['Subheading', 'formatBlock', 'H4'],\r\n  // ['ùô≤ùöòùöçùöé', 'formatBlock', 'PRE'],\r\n]);\r\n\r\nfunction createDropdown(title: string, items: DropDownItem[]): typeof Dropdown {\r\n  DropdownFactory.displayName = title;\r\n\r\n  return DropdownFactory;\r\n\r\n  function DropdownFactory(props: DropdownProps) {\r\n    const editorState = useEditorState();\r\n\r\n    if (editorState.htmlMode) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Dropdown {...props} onChange={onChange} title={title} items={items} />\r\n    );\r\n\r\n    function onChange(e: ChangeEvent<HTMLSelectElement>) {\r\n      const selected = parseInt(e.target.value, 10);\r\n      const [, command, commandArgument] = items[selected];\r\n\r\n      e.preventDefault();\r\n      e.target.selectedIndex = 0;\r\n\r\n      if (typeof command === 'function') {\r\n        command(editorState);\r\n      } else {\r\n        document.execCommand(command, false, commandArgument);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function Dropdown({ items, selected, ...inputProps }: DropdownProps) {\r\n  return (\r\n    <select {...inputProps} value={selected} className=\"rsw-dd\">\r\n      <option hidden>{inputProps.title}</option>\r\n      {items.map((item, index) => (\r\n        <option key={item[2]} value={index}>\r\n          {item[0]}\r\n        </option>\r\n      ))}\r\n    </select>\r\n  );\r\n}\r\n\r\nexport type DropDownItem = [\r\n  string,\r\n  string | ((editorState: EditorState) => void),\r\n  string,\r\n];\r\n\r\nexport interface DropdownProps extends HTMLAttributes<HTMLSelectElement> {\r\n  selected?: number;\r\n  items?: DropDownItem[];\r\n}\r\n","import * as React from 'react';\r\nimport { useEditorState } from '../editor/EditorContext';\r\n\r\nexport function HtmlButton({ ...rest }) {\r\n  const editorState = useEditorState();\r\n\r\n  function onClick() {\r\n    editorState.update({\r\n      htmlMode: !editorState.htmlMode,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      title=\"HTML mode\"\r\n      className=\"rsw-btn\"\r\n      onClick={onClick}\r\n      data-active={editorState.htmlMode}\r\n      {...rest}\r\n    >\r\n      &lt;/&gt;\r\n    </button>\r\n  );\r\n}\r\n","import * as React from 'react';\r\nimport { useEditorState } from '../editor/EditorContext';\r\n\r\nexport function Separator() {\r\n  const editorState = useEditorState();\r\n\r\n  if (editorState.htmlMode) {\r\n    return null;\r\n  }\r\n\r\n  return <div className=\"rsw-separator\" />;\r\n}\r\n","import * as React from 'react';\r\nimport { HTMLAttributes } from 'react';\r\n\r\nexport function Toolbar(props: HTMLAttributes<HTMLDivElement>) {\r\n  return <div {...props} className=\"rsw-toolbar\" />;\r\n}\r\n","import * as React from 'react';\r\nimport { Editor, EditorProps } from './Editor';\r\nimport { EditorProvider } from './EditorContext';\r\nimport {\r\n  BtnBold,\r\n  BtnBulletList,\r\n  BtnClearFormatting,\r\n  BtnItalic,\r\n  BtnLink,\r\n  BtnNumberedList,\r\n  BtnRedo,\r\n  BtnStyles,\r\n  BtnUnderline,\r\n  BtnUndo,\r\n  HtmlButton,\r\n  Separator,\r\n  Toolbar,\r\n} from '../toolbar';\r\n\r\nexport function DefaultEditor(props: EditorProps) {\r\n  return (\r\n    <EditorProvider>\r\n      <Editor {...props}>\r\n        <Toolbar>\r\n          <BtnUndo />\r\n          <BtnRedo />\r\n          <Separator />\r\n          <BtnBold />\r\n          <BtnItalic />\r\n          <BtnUnderline />\r\n          <Separator />\r\n          <BtnNumberedList />\r\n          <BtnBulletList />\r\n          <Separator />\r\n          <BtnLink />\r\n          <BtnClearFormatting />\r\n          <HtmlButton />\r\n          <Separator />\r\n          <BtnStyles />\r\n        </Toolbar>\r\n      </Editor>\r\n    </EditorProvider>\r\n  );\r\n}\r\n"],"names":["React"],"mappings":"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"}